<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="detailPageTitle">BookStore - Chi ti·∫øt S·∫£n ph·∫©m</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
            color: white !important;
        }

        .nav-link {
            color: rgba(255,255,255,0.9) !important;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            color: white !important;
            transform: translateY(-2px);
        }

        .btn-auth {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .btn-auth:hover {
            background: white;
            color: #667eea;
        }

        .cart-icon {
            position: relative;
            color: white;
            font-size: 1.2rem;
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-detail-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 40px;
            margin-top: 50px;
        }

        .product-detail-image {
            height: 350px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6rem;
            color: #e67e22;
            margin-bottom: 20px;
        }

        .detail-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .detail-price {
            color: #e74c3c;
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .btn-add-cart {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-add-cart:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
        }

        .btn-order {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa8a8 100%);
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 600;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .btn-order:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 40px 0 20px 0;
            margin-top: 60px;
        }

        .modal-content {
            border-radius: 15px;
            border: none;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px 15px 0 0;
        }

        /* Styles cho ƒê√°nh gi√° v√† B√¨nh lu·∫≠n */
        .rating-star {
            color: #ffc107; /* M√†u v√†ng cho ng√¥i sao */
        }
        .review-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #fcfcfc;
        }
        .comment-area {
            margin-top: 30px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
        <a class="navbar-brand" href="mainInterface.html"><i class="fas fa-book-open"></i> BookStore</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="mainInterface.html">Trang ch·ªß</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="product.html">S·∫£n ph·∫©m</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Gi·ªõi thi·ªáu</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Li√™n h·ªá</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Voucher</a>
                </li>
            </ul>

            <div class="d-flex align-items-center">
                <a href="#" class="btn btn-auth btn-sm">
                    <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
                </a>
                <a href="#" class="btn btn-auth btn-sm">
                    <i class="fas fa-user-plus"></i> ƒêƒÉng k√Ω
                </a>

                <div class="cart-icon ms-3" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#cartModal">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-badge" id="cartCount">0</span>
                </div>
            </div>
        </div>
    </div>
</nav>

<div class="container">
    <div class="product-detail-card">
        <div class="row">
            <div class="col-lg-5">
                <div class="product-detail-image" id="productIcon">
                    ?
                </div>
                <div class="text-center mt-3">
                    <a href="product.html" class="text-muted"><i class="fas fa-arrow-left"></i> Quay l·∫°i trang s·∫£n ph·∫©m</a>
                </div>
            </div>
            <div class="col-lg-7">
                <h2 class="detail-title" id="productName">T√™n s·∫£n ph·∫©m</h2>
                <p class="text-muted mb-4" id="productCategory">Danh m·ª•c: ƒêang t·∫£i...</p>

                <div class="mb-3">
                    <span class="rating-star"><i class="fas fa-star"></i></span>
                    <span class="rating-star"><i class="fas fa-star"></i></span>
                    <span class="rating-star"><i class="fas fa-star"></i></span>
                    <span class="rating-star"><i class="fas fa-star"></i></span>
                    <span class="text-muted ms-2">(4.0 / 5) - <span id="reviewCount">2</span> ƒê√°nh gi√°</span>
                </div>

                <p class="lead" id="productDescriptionShort">M√¥ t·∫£ t√≥m t·∫Øt s·∫£n ph·∫©m.</p>

                <ul class="list-unstyled mb-4">
                    <li><i class="fas fa-check-circle text-success me-2"></i> C√≤n h√†ng</li>
                    <li><i class="fas fa-tag text-info me-2"></i> M√£ s·∫£n ph·∫©m: <span id="productId">#000</span></li>
                    <li><i class="fas fa-book-reader text-warning me-2"></i> ƒê·ªëi t∆∞·ª£ng: H·ªçc sinh, Sinh vi√™n</li>
                </ul>

                <div class="d-flex align-items-center mb-4">
                    <h3 class="detail-price me-4" id="productPrice">0ƒë</h3>
                    <div class="input-group" style="width: 150px;">
                        <button class="btn btn-outline-secondary" type="button" onclick="changeQuantity(-1)">-</button>
                        <input type="text" class="form-control text-center" id="quantityInput" value="1" readonly>
                        <button class="btn btn-outline-secondary" type="button" onclick="changeQuantity(1)">+</button>
                    </div>
                </div>

                <div class="d-flex">
                    <button class="btn btn-add-cart" id="addToCartBtn" data-id="0">
                        <i class="fas fa-cart-plus"></i> Th√™m v√†o gi·ªè
                    </button>
                    <button class="btn btn-order" id="orderNowBtn" data-id="0">
                        <i class="fas fa-shopping-bag"></i> ƒê·∫∑t h√†ng ngay
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-5">
        <div class="col-12">
            <ul class="nav nav-tabs" id="productDetailTabs">
                <li class="nav-item">
                    <button class="nav-link active" id="detail-tab" data-bs-toggle="tab" data-bs-target="#detailContent" type="button">M√¥ t·∫£ chi ti·∫øt</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#reviewContent" type="button">ƒê√°nh gi√° (<span id="reviewTabCount">2</span>)</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="comment-tab" data-bs-toggle="tab" data-bs-target="#commentContent" type="button">B√¨nh lu·∫≠n</button>
                </li>
            </ul>
            <div class="tab-content bg-white p-4 border border-top-0 rounded-bottom">
                <div class="tab-pane fade show active" id="detailContent">
                    <h4 class="mb-3">Th√¥ng tin chi ti·∫øt s·∫£n ph·∫©m</h4>
                    <p id="productDescriptionFull">ƒê√¢y l√† m√¥ t·∫£ chi ti·∫øt c·ªßa s·∫£n ph·∫©m. N·ªôi dung n√†y c√≥ th·ªÉ d√†i h∆°n v√† bao g·ªìm th√¥ng tin v·ªÅ t√°c gi·∫£, nh√† xu·∫•t b·∫£n, s·ªë trang, v√† c√°c n·ªôi dung chuy√™n s√¢u kh√°c.</p>
                    <ul>
                        <li>**T√°c gi·∫£:** Nguy·ªÖn VƒÉn A</li>
                        <li>**Nh√† xu·∫•t b·∫£n:** Gi√°o d·ª•c</li>
                        <li>**NƒÉm xu·∫•t b·∫£n:** 2024</li>
                    </ul>
                </div>

                <div class="tab-pane fade" id="reviewContent">
                    <h4 class="mb-4">ƒê√°nh gi√° t·ª´ kh√°ch h√†ng (<span id="reviewContentCount">2</span>)</h4>

                    <div id="reviewList">
                        <div class="review-card">
                            <h5>Nguy·ªÖn Th·ªã B <small class="text-muted float-end">20/10/2024</small></h5>
                            <div>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="far fa-star"></i></span>
                            </div>
                            <p class="mt-2 mb-0">S√°ch r·∫•t hay v√† ch·∫•t l∆∞·ª£ng, n·ªôi dung b√°m s√°t ch∆∞∆°ng tr√¨nh h·ªçc. Giao h√†ng nhanh!</p>
                        </div>
                        <div class="review-card">
                            <h5>Tr·∫ßn VƒÉn C <small class="text-muted float-end">15/10/2024</small></h5>
                            <div>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                                <span class="rating-star"><i class="fas fa-star"></i></span>
                            </div>
                            <p class="mt-2 mb-0">Tuy·ªát v·ªùi! T√†i li·ªáu c·ª±c k·ª≥ h·ªØu √≠ch cho vi·ªác t·ª± h·ªçc v√† √¥n thi.</p>
                        </div>
                    </div>

                    <hr>
                    <div class="comment-area">
                        <h5 class="mb-3">Vi·∫øt ƒë√°nh gi√° c·ªßa b·∫°n</h5>
                        <form onsubmit="submitReview(event)">
                            <div class="mb-3">
                                <label class="form-label">Ch·ªçn ƒëi·ªÉm ƒë√°nh gi√°:</label><br>
                                <div id="starRating">
                                    <i class="far fa-star rating-star" data-rating="1" onclick="setRating(1)"></i>
                                    <i class="far fa-star rating-star" data-rating="2" onclick="setRating(2)"></i>
                                    <i class="far fa-star rating-star" data-rating="3" onclick="setRating(3)"></i>
                                    <i class="far fa-star rating-star" data-rating="4" onclick="setRating(4)"></i>
                                    <i class="far fa-star rating-star" data-rating="5" onclick="setRating(5)"></i>
                                    <input type="hidden" id="reviewRating" value="0" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="reviewerName" class="form-label">T√™n c·ªßa b·∫°n</label>
                                <input type="text" class="form-control" id="reviewerName" required>
                            </div>
                            <div class="mb-3">
                                <label for="reviewText" class="form-label">N·ªôi dung ƒë√°nh gi√°</label>
                                <textarea class="form-control" id="reviewText" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">G·ª≠i ƒë√°nh gi√°</button>
                        </form>
                    </div>
                </div>

                <div class="tab-pane fade" id="commentContent">
                    <h4 class="mb-4">B√¨nh lu·∫≠n v·ªÅ s·∫£n ph·∫©m</h4>

                    <div id="commentList">
                        <div class="review-card">
                            <h6>L√™ VƒÉn D <small class="text-muted float-end">21/10/2024</small></h6>
                            <p class="mb-0">C√≥ ai bi·∫øt s√°ch n√†y c√≥ b·∫£n PDF kh√¥ng ·∫°? Em mu·ªën tham kh·∫£o tr∆∞·ªõc.</p>
                        </div>
                        <div class="review-card">
                            <h6>Admin BookStore <small class="text-muted float-end">22/10/2024</small></h6>
                            <p class="mb-0">@L√™ VƒÉn D: Ch√†o b·∫°n, hi·ªán t·∫°i BookStore ch·ªâ cung c·∫•p b·∫£n in. B·∫°n c√≥ th·ªÉ gh√© thƒÉm c·ª≠a h√†ng ƒë·ªÉ xem tr∆∞·ªõc s·∫£n ph·∫©m nh√©!</p>
                        </div>
                    </div>

                    <hr>
                    <div class="comment-area">
                        <h5 class="mb-3">Th√™m b√¨nh lu·∫≠n</h5>
                        <form onsubmit="submitComment(event)">
                            <div class="mb-3">
                                <label for="commenterName" class="form-label">T√™n c·ªßa b·∫°n</label>
                                <input type="text" class="form-control" id="commenterName" required>
                            </div>
                            <div class="mb-3">
                                <label for="commentText" class="form-label">N·ªôi dung b√¨nh lu·∫≠n</label>
                                <textarea class="form-control" id="commentText" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">G·ª≠i b√¨nh lu·∫≠n</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h5><i class="fas fa-book-open"></i> BookStore</h5>
                <p>C·ª≠a h√†ng s√°ch h·ªçc t·∫≠p h√†ng ƒë·∫ßu cho h·ªçc sinh c·∫•p 3</p>
            </div>
            <div class="col-md-4">
                <h5>Li√™n h·ªá</h5>
                <p><i class="fas fa-phone"></i> 0123 456 789</p>
                <p><i class="fas fa-envelope"></i> info@bookstore.vn</p>
                <p><i class="fas fa-map-marker-alt"></i> 123 ƒê∆∞·ªùng ABC, TP.HCM</p>
            </div>
            <div class="col-md-4">
                <h5>Theo d√µi ch√∫ng t√¥i</h5>
                <div class="d-flex">
                    <a href="#" class="text-white me-3"><i class="fab fa-facebook fa-2x"></i></a>
                    <a href="#" class="text-white me-3"><i class="fab fa-instagram fa-2x"></i></a>
                    <a href="#" class="text-white"><i class="fab fa-youtube fa-2x"></i></a>
                </div>
            </div>
        </div>
        <hr class="my-4">
        <div class="text-center">
            <p>&copy; 2024 BookStore. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
        </div>
    </div>
</footer>

<div class="modal fade" id="cartModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-shopping-cart"></i> Gi·ªè h√†ng</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="cartItems">
                    <p class="text-center text-muted">Gi·ªè h√†ng tr·ªëng</p>
                </div>
                <div class="d-flex justify-content-between align-items-center mt-3">
                    <h5>T·ªïng c·ªông: <span id="totalPrice">0ƒë</span></h5>
                    <button class="btn btn-primary-custom" onclick="checkout()">
                        <i class="fas fa-credit-card"></i> Thanh to√°n
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Sample product data (gi·ªØ nguy√™n t·ª´ mainInterface.html)
    const products = [
        {
            id: 1,
            name: "To√°n h·ªçc 12 - S√°ch gi√°o khoa",
            price: 45000,
            category: "giaokho",
            categoryName: "S√°ch gi√°o khoa",
            description: "S√°ch gi√°o khoa To√°n h·ªçc l·ªõp 12, ch∆∞∆°ng tr√¨nh m·ªõi, ƒë·∫ßy ƒë·ªß ki·∫øn th·ª©c c∆° b·∫£n v√† n√¢ng cao theo quy ƒë·ªãnh c·ªßa B·ªô Gi√°o d·ª•c.",
            descriptionFull: "T√†i li·ªáu h·ªçc t·∫≠p ch√≠nh th·ª©c cho h·ªçc sinh l·ªõp 12. Bao g·ªìm c√°c chuy√™n ƒë·ªÅ: H√†m s·ªë, T√≠ch ph√¢n, S·ªë ph·ª©c, H√¨nh h·ªçc Oxyz v√† c√°c b√†i to√°n th·ª±c t·∫ø. Phi√™n b·∫£n m·ªõi nh·∫•t nƒÉm 2024.",
            icon: "üìö"
        },
        {
            id: 2,
            name: "V·∫≠t l√Ω 11 - B√†i t·∫≠p n√¢ng cao",
            price: 65000,
            category: "thamkhao",
            categoryName: "S√°ch tham kh·∫£o",
            description: "B·ªô s√°ch b√†i t·∫≠p V·∫≠t l√Ω n√¢ng cao v·ªõi nhi·ªÅu d·∫°ng b√†i hay, l·ªùi gi·∫£i chi ti·∫øt gi√∫p h·ªçc sinh √¥n luy·ªán v√† ƒë·∫°t ƒëi·ªÉm cao trong c√°c k·ª≥ thi.",
            descriptionFull: "Cu·ªën s√°ch t·ªïng h·ª£p h∆°n 500 b√†i t·∫≠p n√¢ng cao v·ªÅ ƒêi·ªán h·ªçc, Quang h·ªçc v√† Dao ƒë·ªông. M·ªói ch∆∞∆°ng ƒë·ªÅu c√≥ t√≥m t·∫Øt l√Ω thuy·∫øt v√† ph∆∞∆°ng ph√°p gi·∫£i nhanh. R·∫•t th√≠ch h·ª£p cho h·ªçc sinh √¥n thi ƒê·∫°i h·ªçc.",
            icon: "‚ö°"
        },
        {
            id: 3,
            name: "English Grammar in Use",
            price: 120000,
            category: "tienganh",
            categoryName: "Ti·∫øng Anh",
            description: "S√°ch ng·ªØ ph√°p ti·∫øng Anh c∆° b·∫£n ƒë·∫øn n√¢ng cao, gi·∫£i th√≠ch r√µ r√†ng, k√®m b√†i t·∫≠p th·ª±c h√†nh phong ph√∫. Ph√π h·ª£p cho ng∆∞·ªùi t·ª± h·ªçc.",
            descriptionFull: "T√†i li·ªáu ng·ªØ ph√°p kinh ƒëi·ªÉn, ƒë∆∞·ª£c bi√™n so·∫°n b·ªüi Raymond Murphy. Bao g·ªìm 145 ch·ªß ƒëi·ªÉm ng·ªØ ph√°p t·ª´ A-Z, k√®m theo ƒë√°p √°n chi ti·∫øt v√† b√†i ki·ªÉm tra ƒë·ªãnh k·ª≥.",
            icon: "üá¨üáß"
        },
        {
            id: 4,
            name: "H√≥a h·ªçc 10 - S√°ch gi√°o khoa",
            price: 42000,
            category: "giaokho",
            categoryName: "S√°ch gi√°o khoa",
            description: "S√°ch gi√°o khoa H√≥a h·ªçc l·ªõp 10, ch∆∞∆°ng tr√¨nh chu·∫©n, cung c·∫•p ki·∫øn th·ª©c n·ªÅn t·∫£ng v·ªØng ch·∫Øc v·ªÅ h√≥a v√¥ c∆° v√† h·ªØu c∆°.",
            descriptionFull: "N·ªôi dung bao g·ªìm: C·∫•u t·∫°o nguy√™n t·ª≠, B·∫£ng tu·∫ßn ho√†n, Li√™n k·∫øt h√≥a h·ªçc v√† c√°c ph·∫£n ·ª©ng c∆° b·∫£n. S√°ch ƒë∆∞·ª£c in m√†u, h√¨nh ·∫£nh minh h·ªça r√µ n√©t, d·ªÖ hi·ªÉu.",
            icon: "üß™"
        },
        {
            id: 5,
            name: "K·ªπ nƒÉng h·ªçc t·∫≠p hi·ªáu qu·∫£",
            price: 85000,
            category: "kynang",
            categoryName: "K·ªπ nƒÉng s·ªëng",
            description: "H∆∞·ªõng d·∫´n ph∆∞∆°ng ph√°p h·ªçc t·∫≠p hi·ªáu qu·∫£ cho h·ªçc sinh, bao g·ªìm c√°ch qu·∫£n l√Ω th·ªùi gian, ghi nh·ªõ v√† l√†m b√†i thi t·ªëi ∆∞u.",
            descriptionFull: "Cu·ªën s√°ch cung c·∫•p c√°c k·ªπ thu·∫≠t h·ªçc t·∫≠p hi·ªán ƒë·∫°i nh∆∞ ph∆∞∆°ng ph√°p Pomodoro, Mind Mapping v√† k·ªπ thu·∫≠t ghi nh·ªõ si√™u t·ªëc. Gi√∫p h·ªçc sinh t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t h·ªçc t·∫≠p.",
            icon: "üí°"
        },
        {
            id: 6,
            name: "VƒÉn h·ªçc 12 - Tuy·ªÉn t·∫≠p",
            price: 55000,
            category: "giaokho",
            categoryName: "S√°ch gi√°o khoa",
            description: "Tuy·ªÉn t·∫≠p vƒÉn h·ªçc Vi·ªát Nam v√† th·∫ø gi·ªõi l·ªõp 12, ph√¢n t√≠ch chuy√™n s√¢u c√°c t√°c ph·∫©m quan tr·ªçng ph·ª•c v·ª• cho √¥n thi t·ªët nghi·ªáp.",
            descriptionFull: "Tuy·ªÉn ch·ªçn c√°c t√°c ph·∫©m tr·ªçng t√¢m theo ch∆∞∆°ng tr√¨nh B·ªô Gi√°o d·ª•c. K√®m theo ph·∫ßn ph√¢n t√≠ch, g·ª£i √Ω d√†n b√†i v√† b√†i vƒÉn m·∫´u cho t·ª´ng t√°c ph·∫©m.",
            icon: "üìñ"
        }
    ];

    let cart = []; // Gi·ªè h√†ng ƒë∆°n gi·∫£n
    let currentRating = 0; // Bi·∫øn l∆∞u tr·ªØ ƒë√°nh gi√° hi·ªán t·∫°i

    // Load product detail on page load
    document.addEventListener('DOMContentLoaded', function() {
        loadProductDetail();
        // T·∫£i gi·ªè h√†ng t·ª´ localStorage n·∫øu c√≥
        const storedCart = localStorage.getItem('bookstoreCart');
        if (storedCart) {
            cart = JSON.parse(storedCart);
            updateCartUI();
        }

        // G·∫Øn s·ª± ki·ªán cho n√∫t Th√™m v√†o gi·ªè h√†ng v√† ƒê·∫∑t h√†ng
        document.getElementById('addToCartBtn').addEventListener('click', function() {
            const productId = parseInt(this.getAttribute('data-id'));
            const quantity = parseInt(document.getElementById('quantityInput').value);
            if (productId > 0) {
                addToCart(productId, quantity);
            }
        });

        document.getElementById('orderNowBtn').addEventListener('click', function() {
            const productId = parseInt(this.getAttribute('data-id'));
            const quantity = parseInt(document.getElementById('quantityInput').value);
            if (productId > 0) {
                orderNow(productId, quantity);
            }
        });
    });

    // H√†m l·∫•y tham s·ªë t·ª´ URL
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        const results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }

    // H√†m t·∫£i chi ti·∫øt s·∫£n ph·∫©m
    function loadProductDetail() {
        const productId = parseInt(getUrlParameter('id'));
        // Gi·∫£ s·ª≠: L·∫•y s·∫£n ph·∫©m 1 n·∫øu kh√¥ng c√≥ id (ƒë·ªÉ trang kh√¥ng tr·ªëng)
        const product = products.find(p => p.id === productId) || products[0];

        if (product) {
            document.getElementById('detailPageTitle').textContent = `BookStore - ${product.name}`;
            document.getElementById('productName').textContent = product.name;
            document.getElementById('productCategory').textContent = `Danh m·ª•c: ${product.categoryName || product.category}`;
            document.getElementById('productDescriptionShort').textContent = product.description;
            document.getElementById('productDescriptionFull').textContent = product.descriptionFull || product.description; // L·∫•y m√¥ t·∫£ ƒë·∫ßy ƒë·ªß
            document.getElementById('productPrice').textContent = formatPrice(product.price);
            document.getElementById('productIcon').innerHTML = product.icon;
            document.getElementById('productId').textContent = `#${product.id.toString().padStart(3, '0')}`;

            // C·∫≠p nh·∫≠t ID cho c√°c n√∫t ch·ª©c nƒÉng
            document.getElementById('addToCartBtn').setAttribute('data-id', product.id);
            document.getElementById('orderNowBtn').setAttribute('data-id', product.id);
        } else {
            document.getElementById('productName').textContent = 'Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m';
            document.getElementById('productDescriptionShort').textContent = 'S·∫£n ph·∫©m b·∫°n ƒëang t√¨m kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ b·ªã x√≥a.';
            document.getElementById('productPrice').textContent = '---';
            document.getElementById('productIcon').innerHTML = '‚ùå';
        }
    }

    // Thay ƒë·ªïi s·ªë l∆∞·ª£ng
    function changeQuantity(change) {
        const quantityInput = document.getElementById('quantityInput');
        let currentQuantity = parseInt(quantityInput.value);
        currentQuantity += change;
        if (currentQuantity < 1) currentQuantity = 1;
        quantityInput.value = currentQuantity;
    }

    // Format price
    function formatPrice(price) {
        return new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND'
        }).format(price);
    }

    // --- Ch·ª©c nƒÉng ƒê√°nh gi√° (Review) ---

    function setRating(rating) {
        currentRating = rating;
        document.getElementById('reviewRating').value = rating;
        const stars = document.getElementById('starRating').querySelectorAll('.rating-star');
        stars.forEach((star, index) => {
            if (index < rating) {
                star.classList.replace('far', 'fas');
            } else {
                star.classList.replace('fas', 'far');
            }
        });
    }

    function submitReview(event) {
        event.preventDefault();
        const name = document.getElementById('reviewerName').value;
        const text = document.getElementById('reviewText').value;
        const rating = parseInt(document.getElementById('reviewRating').value);

        if (rating === 0) {
            showNotification('Vui l√≤ng ch·ªçn ƒëi·ªÉm ƒë√°nh gi√° (1-5 sao)!', 'warning');
            return;
        }

        // T·∫°o HTML cho ƒë√°nh gi√° m·ªõi
        const newReviewHTML = `
                <div class="review-card">
                    <h5>${name} <small class="text-muted float-end">${new Date().toLocaleDateString('vi-VN')}</small></h5>
                    <div>
                        ${'<span class="rating-star"><i class="fas fa-star"></i></span>'.repeat(rating)}
                        ${'<span class="rating-star"><i class="far fa-star"></i></span>'.repeat(5 - rating)}
                    </div>
                    <p class="mt-2 mb-0">${text}</p>
                </div>
            `;

        document.getElementById('reviewList').insertAdjacentHTML('afterbegin', newReviewHTML);

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng ƒë√°nh gi√° (T·∫°m th·ªùi)
        const countElement = document.getElementById('reviewCount');
        const currentCount = parseInt(countElement.textContent);
        countElement.textContent = currentCount + 1;
        document.getElementById('reviewTabCount').textContent = currentCount + 1;
        document.getElementById('reviewContentCount').textContent = currentCount + 1;

        showNotification('ƒê√°nh gi√° c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!', 'success');
        event.target.reset(); // Reset form
        setRating(0); // Reset stars
    }

    // --- Ch·ª©c nƒÉng B√¨nh lu·∫≠n (Comment) ---

    function submitComment(event) {
        event.preventDefault();
        const name = document.getElementById('commenterName').value;
        const text = document.getElementById('commentText').value;

        // T·∫°o HTML cho b√¨nh lu·∫≠n m·ªõi
        const newCommentHTML = `
                <div class="review-card">
                    <h6>${name} <small class="text-muted float-end">${new Date().toLocaleDateString('vi-VN')}</small></h6>
                    <p class="mb-0">${text}</p>
                </div>
            `;

        document.getElementById('commentList').insertAdjacentHTML('afterbegin', newCommentHTML);

        showNotification('B√¨nh lu·∫≠n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 'success');
        event.target.reset(); // Reset form
    }

    // --- Ch·ª©c nƒÉng Gi·ªè h√†ng (Gi·ªØ nguy√™n) ---

    function addToCart(productId, quantity = 1) {
        const product = products.find(p => p.id === productId);
        if (!product) return;

        const existingItem = cart.find(item => item.id === productId);

        if (existingItem) {
            existingItem.quantity += quantity;
        } else {
            cart.push({ ...product, quantity: quantity });
        }

        localStorage.setItem('bookstoreCart', JSON.stringify(cart));
        updateCartUI();
        showNotification(`ƒê√£ th√™m ${quantity} x ${product.name} v√†o gi·ªè h√†ng!`, 'success');
    }

    function orderNow(productId, quantity = 1) {
        addToCart(productId, quantity);
        const cartModal = new bootstrap.Modal(document.getElementById('cartModal'));
        cartModal.show();
    }

    function updateCartUI() {
        const cartCount = document.getElementById('cartCount');
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
        updateCartModal();
    }

    function updateCartModal() {
        const cartItems = document.getElementById('cartItems');
        const totalPrice = document.getElementById('totalPrice');

        if (cart.length === 0) {
            cartItems.innerHTML = '<p class="text-center text-muted">Gi·ªè h√†ng tr·ªëng</p>';
            totalPrice.textContent = '0ƒë';
            return;
        }

        let cartHTML = '';
        let total = 0;

        cart.forEach(item => {
            const itemTotal = item.price * item.quantity;
            total += itemTotal;

            cartHTML += `
                    <div class="d-flex justify-content-between align-items-center border-bottom py-2">
                        <div>
                            <h6 class="mb-0">${item.name}</h6>
                            <small class="text-muted">${formatPrice(item.price)} x ${item.quantity}</small>
                        </div>
                        <div class="d-flex align-items-center">
                            <button class="btn btn-sm btn-outline-secondary me-2" onclick="updateQuantityInCart(${item.id}, -1)">-</button>
                            <span class="mx-2">${item.quantity}</span>
                            <button class="btn btn-sm btn-outline-secondary me-2" onclick="updateQuantityInCart(${item.id}, 1)">+</button>
                            <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
        });

        cartItems.innerHTML = cartHTML;
        totalPrice.textContent = formatPrice(total);
    }

    function updateQuantityInCart(productId, change) {
        const item = cart.find(item => item.id === productId);
        if (item) {
            item.quantity += change;
            if (item.quantity <= 0) {
                removeFromCart(productId);
            } else {
                localStorage.setItem('bookstoreCart', JSON.stringify(cart));
                updateCartUI();
            }
        }
    }

    function removeFromCart(productId) {
        cart = cart.filter(item => item.id !== productId);
        localStorage.setItem('bookstoreCart', JSON.stringify(cart));
        updateCartUI();
    }

    function checkout() {
        if (cart.length === 0) {
            showNotification('Gi·ªè h√†ng tr·ªëng!', 'warning');
            return;
        }

        showNotification('ƒê·∫∑t h√†ng th√†nh c√¥ng! Ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n s·ªõm.', 'success');
        cart = [];
        localStorage.removeItem('bookstoreCart');
        updateCartUI();

        const cartModal = bootstrap.Modal.getInstance(document.getElementById('cartModal'));
        if (cartModal) cartModal.hide();
    }

    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `alert alert-${type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info'} position-fixed`;
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
            `;

        document.body.appendChild(notification);

        setTimeout(() => {
            if (notification.parentElement) {
                notification.remove();
            }
        }, 3000);
    }
</script>
</body>
</html>